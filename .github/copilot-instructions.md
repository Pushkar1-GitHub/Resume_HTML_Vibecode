# Copilot Instructions (Copilot-native) **V2**: PDF→HTML Resume Layout Keeper

**TOP RULES:** Preserve exact visual layout + SVG. Minimal diffs only. No prettify/reindent/reorder.
**LARGE FILES:** Do not rewrite whole file; chunk by page/SVG/CSS; output diff per chunk.
**FORBIDDEN:** Do not remove inline styles/spans/style blocks/@font-face; no semantic rewrite unless asked.

**GENERAL RULES:** No guessing file paths/selectors; if risk≥med ask 1 question; no scope creep; cite anchors for every edit.

> This repo contains HTML resumes generated by PDF→HTML conversion.
> Goal: preserve **exact layout** + **SVG icons**, while enabling safe bloat-reduction + content updates.

---

## Layer 1 (Always ON): English Mirror (Copilot MUST follow)

### General agent rules (still resume-HTML specific)

* **No guessing**: never invent file paths, selectors, or ids. If missing context, request the minimal chunk.
* **Truthfulness**: never claim inspection/testing unless citing `file_path + anchor`.
* **No scope creep**: in content updates/debugging, do not do opportunistic cleanup.
* **Stop-if gate**: stop and ask permission if changes affect layout-contract elements (inline positioning, SVG defs, print CSS, fonts) beyond the requested scope.
* **Change budget**: if changes exceed the budget, propose chunked patches and ask permission.

### What you MUST do

* Treat the converted HTML as **layout-contract code**.
* Preserve **exact visual layout** (not “similar”).
* Preserve **all SVG icons** and SVG defs.
* Make **minimal diffs only** (surgical edits, no rewrites).
* If file is large: **work in chunks**, not whole-file rewrite.
* If unsure whether a change is layout-safe: **do not touch it**.
* If `risk>=med` and unclear: **ask exactly 1 question**.

### What you MUST NOT do

* **Do not remove inline styles** or positioning rules.
* **Do not remove** spans/div wrappers that affect layout.
* **Do not delete** `<style>` blocks or `@font-face` unless user explicitly asks.
* **Do not convert** the resume to “clean semantic HTML” unless user explicitly asks.
* **Do not prettify/reindent** the HTML.
* **Do not reorder attributes**, reorder CSS rules, or reorder HTML blocks.
* **Do not normalize whitespace** in a way that can change text flow/line breaks.

---

<!-- NOTE: DSL section removed because GitHub Copilot does not reliably parse DSL as executable policy.
     All enforcement is expressed in the English mirror + explicit constraints below. -->

## Layer 1 (Always ON): Policy Summary (for quick scanning)

**Non-negotiable:** Preserve exact visual layout + SVG. Minimal diffs. Chunk large files.

---

## Layout Integrity Gate (always)

Before any cleanup/refactor:

1. Identify if file is PDF-layout HTML (absolute positioning / many spans).
2. If yes: treat inline styles + wrappers + css blocks as layout-contract.
3. Only apply layout-safe edits.

> If file is too large to load fully: ask user to specify page/chunk or provide the relevant section.

---

## Allowed edits (layout-safe only)

You may:

* Remove HTML comments.
* Remove redundant/non-rendering `<meta>` tags.
* Collapse repeated whitespace/newlines **only in ways that cannot change flow**.
* Remove unused CSS rules **ONLY if you can cite exact selector that never appears in the file** (no guessing).

### Explicit forbidden examples

* ❌ Do not remove `<span>` wrappers even if they look redundant.
* ❌ Do not strip `style="position:absolute; left:...; top:..."`.
* ❌ Do not replace absolute positioning with flex/grid.
* ❌ Do not simplify or optimize SVG `<path>`/`<defs>`.

---

## Output rules

* Prefer **unified diff patches**.
* Output should be:

  1. **Index of changes** (chunk/page → summary)
  2. **Diff patch only**
  3. No extra commentary
* If a single edit touches >30 LOC: output the **full updated file**.
* Never claim “I checked X” unless you cite exact `file_path` + anchor.

---

## Layer 2 (Optional): Extended Rules

Turn ON only if: repo is large, requirements messy, or risk = high.

### Extended Rules = ON

* Provide rollback plan for risky changes.
* Always provide 2 options with tradeoffs when `risk=high` or file is large.
* Provide invariants checklist:

  * layout unchanged
  * print unchanged
  * svg unchanged
  * text unchanged (unless requested)
* Proof-of-done mapping to CI/scripts (cite from repo).
